
leads_data = """
Evgenia Zarubin	Core Realty Accosiates Inc	номер передан Саше	2	February	6.02	February	Week 7	Igor Smirnov	https://linkedin.com/in/evgenia-zarubin	Встреча состоялась	21.10 - Ex-employees of Sberbank, VTB, Alfa-Bank, Gazprombank, Otkritie - formal vs. familiar tone and opinion query vs. direct call offer	https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcTvd8G55m3eY9ocqKlQo557_NMN4p73ExknvDDte5N3V4bTzw
Maria Erokhina	JSC Sberbank	Executive Director, Project manager	3	February	6.02	February	Week 7	Roman Vashkevich	https://linkedin.com/in/maria-erokhina-850303345	Встреча состоялась	21.10 - Ex-employees of Sberbank, VTB, Alfa-Bank, Gazprombank, Otkritie - formal vs. familiar tone and opinion query vs. direct call offer	https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcRXAKiT50wgYMuR34M6aFPXPzlOuvCwYJjuP4mUpDZoF7O-TQ
Nikoloz Shurgaia	Various Companies	Management Consultant	4	February	9.02			Roman Vashkevich	https://linkedin.com/in/nikoloz-shurgaia-4b011a	Встреча состоялась	22.01 / financial advisors Georgia / face-to-face meeting--copy	no photo
Irina I.	Unreal Nova Academy	Founder	1	February	9.02			Ruslan Pshenin	https://linkedin.com/in/irina-i-60b77a10a	Встреча состоялась	22.01 / investors Georgia / face-to-face meeting	https://media.licdn.com/dms/image/v2/D4D35AQFSUEVl5WMFQg/profile-framedphoto-shrink_800_800/B4DZrp2hEpIAAg-/0/1764859974316?e=1771851600&v=beta&t=lDQJCgN_ArqpR9x6GxCAQrrZc35KQ0t62rHo811NRnQ
Askar Toksanbayev	AT Finconsult	Founder and CEO	4	February	9.02			Ruslan Pshenin	https://linkedin.com/in/askartoxanbayev	Встреча состоялась	22.01 / investors CIS / face-to-face meeting	https://media.licdn.com/dms/image/v2/D5603AQFZoC5-GSsVRQ/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1706778040515?e=1772668800&v=beta&t=Aj__p7eKjZIa9hHc3gZMwuVjlrvEUyR2yQ3jRkSEC1M
Ramprabu Chennakesavan	RAGHAV CONTRACTING LLC	Executive Director		February	9.02			Alexandra Nazarova	https://linkedin.com/in/ramprabu	Запланирована	UAE - Angel investors - 3.10 (linkedIn search)	https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTLFN8qqxh2EvaEna42yl15_2EN5xa8eRupKFXKtMGOTM6Jpg
Hashim Bakuvi	Joygame Publishing	Partner		February	10.02			Ruslan Pshenin	https://linkedin.com/in/hashim82	Запланирована	22.01 / investors CIS / face-to-face meeting	https://media.licdn.com/dms/image/v2/D4D03AQHVTxU_WeSl5A/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1726566877252?e=1772668800&v=beta&t=sgO2I-18ISs2TNAyJN6OUcCGssYxDLcDhi6RXfd8SqI
Aleksey Klementyev	Uniconf	Senior Finance Business Partner	2	February	10.02			Ruslan Pshenin	https://linkedin.com/in/aleksey-klementyev	Встреча состоялась	22.01 / financial advisors Georgia / face-to-face meeting--copy	https://media.licdn.com/dms/image/v2/D4D03AQFTptIaRHVZDw/profile-displayphoto-shrink_800_800/B4DZUP2LQAGkAk-/0/1739727616031?e=1772668800&v=beta&t=beP6J7a4kAbI-fuIEws1cUpYqs40kJ-bJmvz6o-R84U
Nino Putkaradze	ideal smile	finance	1	February	10.02			Ruslan Pshenin	https://linkedin.com/in/nino-putkaradze-42928a397	Встреча состоялась	22.01 / financial advisors Georgia / face-to-face meeting--copy	https://media.licdn.com/dms/image/v2/D4E03AQG0KCcqTzpMqg/profile-displayphoto-crop_800_800/B4EZo_Ihu1IQAI-/0/1761995791747?e=1772668800&v=beta&t=kLRNXOdSoMRjo6DXiA19NJEs9kOQ6dH89S04KiAD_kk
Mehman Abbas	ADB Ventures	Investment Advisory 		February	11.02			Roman Vashkevich	https://linkedin.com/in/mehman-a-abbas-54251aa	личная встреча	22.01 / financial advisors CIS / face-to-face meeting	https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcSywgEiRmTGvwJFsuG_4piMAqs3u5uf-VYPqVOZNsW0ag5izg
Islam Kullarov	Turkmenline	ES "At-abray" Head of legal and financial issues		February	12.02			Ruslan Pshenin	https://linkedin.com/in/islam-kullarov-c-a-p	личная встреча	22.01 / financial advisors CIS / face-to-face meeting	https://media.licdn.com/dms/image/v2/D4E35AQFk368ecEf-zA/profile-framedphoto-shrink_800_800/B4EZiYyYIcHIAk-/0/1754909999950?e=1771851600&v=beta&t=0OcTNfpQKcQ-o3hs5oJvuXEbCAmnOQ8Yhnkt6uwpDio
Alexander Lapshin	Sistema	Executive Director		February	12.02			Igor Smirnov	https://linkedin.com/in/alapshin	Запланирована	21.10 - Ex-employees of Sberbank, VTB, Alfa-Bank, Gazprombank, Otkritie - formal vs. familiar tone and opinion query vs. direct call offer	no photo
Felipe Forero	Vontobel	Private Banker		February	12.02			Olga Yatchenya	https://linkedin.com/in/felipe-castaneda-forero-70b21645	Запланирована	30.01 / PBFO / executive director / Geneva, Zurich, Monaco, Luxembourg, Dubai	https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcTkPnGPvucEJKtLKHuiS5_x6F2rJeAkutDDelkbsU2gD1OtAw
Dina Mamytkulova	AIFC	Chief Corporate and Institutional Investors Officer		February	13.02			Ruslan Pshenin	https://linkedin.com/in/dina-mamytkulova-5b391a70	личная встреча	22.01 / investors CIS / face-to-face meeting	https://media.licdn.com/dms/image/v2/C4D03AQGRGldb1F1R0w/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1571635982124?e=1772668800&v=beta&t=CtYsP5RAahtL1PLM-TM0DjtdSGR2Z_HERdeomCof-x8
Elchin Ismayilov	Elchin Ismayilov M.E	Innovation Consultant		February	13.02			Roman Vashkevich	https://linkedin.com/in/elchin-ismayil	личная встреча	22.01 / investors CIS / face-to-face meeting	https://media.licdn.com/dms/image/v2/D4D03AQGXcJFVE3ub8g/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1708988226272?e=1772668800&v=beta&t=eP5q5LthZRgfAjgFgMoKqEBysWcVTuNUys6-e6c0o5g
Muhammad Iqbal	ADIB - Abu Dhabi Islamic Bank	Senior Relationship Manager, Business Banking		February	13.02			Olga Yatchenya	https://linkedin.com/in/muhammad-sajid-iqbal-bb201824	Запланирована	28.01 / PBFO / Senior Relationship Managers / Geneva, Zurich, Monaco, Luxembourg, Dubai	https://media.licdn.com/dms/image/v2/C5103AQFAmuOYfT685g/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1569167756489?e=1772668800&v=beta&t=zjFOzsKRJE7fsGFREgqoqtHX_GpQs8zgooyqhJGH1mk
Mir Hussain	RAKBANK	Associate Vice President and Senior Relationship Manager		February	13.02			Olga Yatchenya	https://linkedin.com/in/mir-meesam-hussain-72523753	Запланирована	28.01 / PBFO / Senior Relationship Managers / Geneva, Zurich, Monaco, Luxembourg, Dubai	no photo
Georgy Grib	Tech Horizons Venture	Venture Studio Consultant	2	February	6.02	February	Week 7	Ruslan Pshenin	https://linkedin.com/in/georgy-grib-187b884	Встреча состоялась	22.01 / investors CIS / face-to-face meeting	https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXEOpluWg98eaL7061pVkXPPcAbtKzOokuWUVBfS73xygxTA
Ari Arjoto	Nusa teknogra indonesia	Private Investor	4	February	5.02	February	Week 7	Igor Smirnov	https://linkedin.com/in/ari-yohan-arjoto-3b3396395	Встреча состоялась	13.12 / Indonesia - Malaysia / private investors	https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcReDstNPsz7R1DtlTfw9xHdX7HvLK8jumRoUrap6_RhENnfeA
Pradipta Mullick	Intertran Technology	COO, Managing Director	1	February	5.02	February	Week 7	Chloé Boutiguila	https://linkedin.com/in/pradiptamullick	Встреча состоялась	Japan - Angel/private investors - 9.10 (linkedIn search)	https://media.licdn.com/dms/image/v2/C5603AQFEGDl9YaNF4A/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1632818586180?e=1772064000&v=beta&t=t6msaKECm9jdym_LkC6gp6Ad8xdHfpuJKlnZ8tn5-mw
Brenda Ng	The Facilitators' Project	Chief Fun(d) Officer (CFO)	2	February	5.02	February	Week 7	Igor Smirnov	https://linkedin.com/in/brenda-ng-3b391922	Встреча состоялась	Hong Kong - Angel/private investors - 9.10 (linkedIn search)	https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcS_0nWCKEjtyrfT26j6cPYt1BgAp_lMLuYSkKR8-vonZGOn8w
Shin Ito		Founder, CEO & Representative Director at iKoyoo, Inc.	5	February	4.02	February	Week 7	Roman Vashkevich	https://linkedin.com/in/shinito123	Встреча состоялась	Japan - Angel/private investors - 9.10 (linkedIn search)	https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTogcrMFc-w0oYCaXYQmxziTyx1UjEJrIMxopWRJ2rEX-TQHQ
Angeline Siow	Grasshopper	Investor Relations Associate	3	February	2.02	February	Week 7	Igor Smirnov	https://linkedin.com/in/angeline-siow-139a521b8	Встреча состоялась	Hong Kong - Angel/private investors - 9.10 (linkedIn search)	https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcTFqX8gBzk1adE8lOOA_UyzdECmIhythMgkiXzPL8lNRfV3fg
Carly Bunni	Ardian	Investor Relations	1	February	2.02	February	Week 7	Igor Smirnov	https://linkedin.com/in/carly-bunni-0845a9211	Встреча состоялась	UAE - Angel investors - 3.10 (linkedIn search)	https://media.licdn.com/dms/image/v2/D4D03AQHOlQvD7xLJUw/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1724582255103?e=1772064000&v=beta&t=AKH7SIRqWwcfrvS7j0nfIJOFi0_YgwolnmcUX6ovYUY
Nicola Pellegrino	Eleven Plus Inc	investor & Advisor	3	January	29.01	February	Week 7	Alexandra Nazarova	https://linkedin.com/in/npellegrino	Встреча состоялась	Hong Kong - Angel/private investors - 9.10 (linkedIn search)	https://media.licdn.com/dms/image/v2/D4D03AQGBqUm28opsdw/profile-displayphoto-crop_800_800/B4DZoLym1MHwAI-/0/1761134412784?e=1771459200&v=beta&t=iaokk4IXf7nK5TeROywt-vSydbo22FBFXYASua4VH4o
"""

import json

lines = leads_data.strip().split('\n')
leads = []

for i, line in enumerate(lines):
    parts = line.split('\t')
    if len(parts) < 11:
        continue
    
    name = parts[0].strip()
    company = parts[1].strip()
    role = parts[2].strip()
    quality_str = parts[3].strip()
    quality = int(quality_str) if quality_str.isdigit() else None
    month_s = parts[4].strip()
    date_s = parts[5].strip()
    month_c = parts[6].strip()
    week_id = parts[7].strip()
    account = parts[8].strip()
    linkedin = parts[9].strip()
    status = parts[10].strip()
    campaign = parts[11].strip() if len(parts) > 11 else ""
    photo = parts[12].strip() if len(parts) > 12 else "no photo"
    
    if photo == "no photo":
        photo = f"https://ui-avatars.com/api/?name={name.replace(' ', '+')}&background=0D8ABC&color=fff"
    
    lead = {
        "id": f"w7-l{i+1}",
        "weekId": "Week 7",
        "name": name,
        "photo": photo,
        "company": company,
        "role": role,
        "quality": quality,
        "status": status,
        "dateScheduled": date_s,
        "dateConducted": month_c if month_c else "February",
        "account": account,
        "linkedin": linkedin,
        "comment": "",
        "campaign": campaign
    }
    leads.append(lead)

import json
json_output = json.dumps(leads, indent=2, ensure_ascii=False)
# Remove the outer brackets for embedding into the TS array
ts_content = json_output.strip()[1:-1].strip()

with open('data.ts', 'r', encoding='utf-8') as f:
    content = f.read()

import re
# Find the range of w7-l1 to w7-l25
# We look for the first occurrence of "id": "w7-l1" and the last line of "id": "w7-l25"
start_marker = '"id": "w7-l1"'
end_marker = '"id": "w7-l25"'

# Find the start of the object containing w7-l1
start_index = content.find(start_marker)
while content[start_index] != '{':
    start_index -= 1

# Find the end of the object containing w7-l25
end_index = content.find(end_marker)
brace_count = 0
found_end = False
for i in range(end_index, len(content)):
    if content[i] == '{':
        brace_count += 1
    elif content[i] == '}':
        brace_count -= 1
        if brace_count == -1: # We are outside the object
             # Wait, we want the end of the CURRENT object.
             # Actually, if we find "w7-l25", we just need to find the matching '}'
             pass
        
# Let's try a simpler regex approach to replace the block
# We know it starts with { "id": "w7-l1" ... and ends with ... "id": "w7-l25", ... }
# But the leads might be spread.
# Actually, I'll just find all leads with weekId: "Week 7" and replace that entire contiguous block.

# First, let's identify the start of the first Week 7 lead and the end of the last one.
all_matches = list(re.finditer(r'\{\s*"id":\s*"w7-l\d+"', content))
if all_matches:
    first_match_start = all_matches[0].start()
    
    # To find the end of the last lead:
    last_match = all_matches[-1]
    last_match_start = last_match.start()
    
    # Find the closing brace of the last lead
    brace_depth = 0
    last_lead_end = -1
    for i in range(last_match_start, len(content)):
        if content[i] == '{':
            brace_depth += 1
        elif content[i] == '}':
            brace_depth -= 1
            if brace_depth == 0:
                last_lead_end = i + 1
                break
    
    if first_match_start != -1 and last_lead_end != -1:
        new_content = content[:first_match_start] + ts_content + content[last_lead_end:]
        with open('data.ts', 'w', encoding='utf-8') as f:
            f.write(new_content)
        print("Successfully updated data.ts")
    else:
        print("Could not find delimiters")
else:
    print("No matches found")
